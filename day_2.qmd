# Day 2

## Antecedents {#sec-why-antecedents}

Spatial econometrics may be seen in a number of different ways, as misguided,
as an inward-looking endeavour for the specially interested, but these views 
are rarely placed in their context. In this section, we will
sketch the antecedents of spatial econometrics, both providing views
on the research context when it came into being, and on changes in
econometrics over time. Grasping spatial econometrics today without
insight into its antecedents is unnecessarily difficult, so taking time
to explore how ideas came into being and developed is well-spent. 
  \index{spatial econometrics!history of}

In the same way that @fujitaetal:99 begin their study of the
spatial economy by looking at the antecedents of their subject, it
is helpful to place spatial econometrics in its temporal and academic
context. This context is sufficiently different from the contemporary
setting that it may be hard to grasp the background for many of the
features of spatial econometrics that came into being during its earlier
years. Indeed, the ranges of topics that were studied in economics in
the 1960's and 1970's differ markedly from those in focus today. If we
can sketch the context within which spatial econometrics was created,
and its methods developed, we should be able to illuminate choices
made then which influence our understanding and application of spatial
econometric methods.
  \index{spatial econometrics}
  \index{space economy}

Critics of the practice of spatial econometrics, such as
@gibbons+overman:12, appear to overlook these antecedents, and
consequently judge the potential of the field on a partial, perhaps
anachronistic, understanding, viewing phenomena with a history in
ahistorical way. Since we are attempting to provide an introduction to
applied spatial econometrics, we need to throw light on the original
motivations and concerns of the first scholars engaged in the field.
@anselin:10 indicates clearly and repeatedly [@anselin:88;
@anselin:06; @anselin:10a] that we should acknowledge *Spatial
Econometrics* by @paelinck+klaassen:79 of the Netherlands Economic
Institute as our starting point, and so celebrated thirty years of
spatial econometrics in 2009. This firm confirmation of the importance
of Jean Paelinck's contributions as scholar and community-builder
is fully justified. We should then turn to the motivations given in
@paelinck+klaassen:79 to indicate which contextual factors were
of importance at that time, and the breadth of the academic communities
with which they were in contact.
  \index{spatial econometrics!history of}

In a recent short commentary, @paelinck:13 [p. 11] recalled his
conviction, expressed in 1967, that 

> early econometric exercises ...
relating only variables posessing the same regional index ... were
inadequate to represent the correct spatial workings of the economy,
which would then be reflected in the policy outcomes. 

A year before,
@paelinck:12 [p. 36] pointed to salient isomorphisms linking
spatial regression models, simultaneous equation models and input-output
models; these were known of and discussed in the early formative period
of spatial econometrics. We will return in subsequent chapters to the
ways in which spatial regression models may be specified, but for now,
a simple presentation of these isomorphisms as perceived in the early
period is sufficient:
  \index{spatial econometrics!history of}

```{r, echo=FALSE, results='asis'}
if (knitr::is_latex_output()) {
cat("\\begin{equation*}\n{\\mathbf y} = {\\mathbf A}{\\mathbf y} + {\\mathbf X}{\\mathbf b} + \\mbfvarepsilon\n\\end{equation*}\n")
} else {
cat("\\begin{equation*}\n{\\mathbf y} = {\\mathbf A}{\\mathbf y} + {\\mathbf X}{\\mathbf b} + {\\mathbf \\varepsilon}\\end{equation*}\n")
}
```
\noindent
is a spatial regression model where ${\mathbf A}$ is a matrix expressing
the mutual first order spatial dependencies between regions --- the
similarity of this form and the Koyck distributed lag model is striking
[@koyck:54; @klein:58; @griliches:67];
  \index{spatial regression model}
  \index{distributed lag model}

```{r, echo=FALSE, results='asis'}
if (knitr::is_latex_output()) {
cat("\\begin{equation*}\n{\\mathbf A}{\\mathbf y} + {\\mathbf X}{\\mathbf b} = \\mbfvarepsilon\n\\end{equation*}\n")
} else {
cat("\\begin{equation*}\n{\\mathbf A}{\\mathbf y} + {\\mathbf X}{\\mathbf b} = {\\mathbf \\varepsilon}\n\\end{equation*}\n")
}
```
\noindent
is a simultaneous equation model where ${\mathbf A}$ is a matrix expressing the dependencies between the equations; and:
  \index{simultaneous equation model}

\begin{equation*}
{\mathbf y} = {\mathbf A}{\mathbf y} + {\mathbf f}
\end{equation*}
\noindent
is an input-output model where ${\mathbf A}$ is a matrix of sectoral 
input-output coefficients, and ${\mathbf f}$ is final demand.
  \index{input-output model}

Input-output models, simultaneous equation models, and the importance of
policy outcomes were all known intimately at the Netherlands Economic
Institute at this time, and elsewhere among applied economists. The
isomporhisms flowed from the known to the unknown, from the stuff of
contemporary research and policy advice to doubts about the calibration
of aspatial models, and on to what became termed spatial econometrics. If
we compare these topics with those described for Regional Science by
@boyce:04, we can see the outlines of research priorities at the
time: including urban and regional models for planning, regional and
interregional input-output models, transport and location models. During
the 1960s and 1970s, many of these models were enhanced, matching needs
for policy advice, to cover environmental questions, adding natural
resources as inputs and pollution to outputs. Paelinck's co-author in a
key paper in spatial econometrics [@hordijk+paelinck:76], went on
to work in environmental management and research.
  \index{Regional Science}
  \index{spatial econometrics!history of}

Reading @paelinck+klaassen:79 [p. viii], we see that the programme
of research into the space economy undertaken at the Netherlands Economic
Institute led first to the publication of @paelinck+nijkamp:75,
and then to @klaassenetal:79, published in the same year as
*Spatial Econometrics*. All three books were published in the
same series and appear to reflect the core concerns of economists at
the Institute doing research on regionalised national macro-economic
models. The direct link to Jan Tinbergen is evident in the account
of the context of economic research in the Netherlands given by
@theil:64 [p. 49]. If we take Paelinck at his word, he and
his colleagues were aware that an aspatial regionalisation of national
accounts, of input-output models, or transport models, might prejudice
policy advice and outcomes through inadequate and inappropriate
calibration.
  \index{Regional Science}
  \index{spatial econometrics!history of}

@klaassenetal:79 is mainly concerned with model construction, while
about a third of @paelinck+nijkamp:75 is devoted to input-output
analysis. Both books show sustained concern for aggregate economic measurement,
especially of national accounts data, intersectoral transactions, and many
other topics. Considerable attention is also paid to the data collection
units, be they sectors or regions.  The need to attempt to define regions
that match the underlying economic realities was recognised clearly, and
a key part of @paelinck+nijkamp:75 is devoted to regionalisation,
and the distinction between functional regions and homogenous regional
classifications is made. In the motivation for spatial econometric
models given in @paelinck+klaassen:79 [pp. 2--3], consumption
and investment in a region are modelled as depending on income both in
the region itself and in its contiguous neighbours, termed a "spatial
income-generating model." It became important to be able to calibrate
planning models of this kind to provide indications of the possible
outcomes of alternative policy choices, hence the need for spatial
econometrics.
  \index{Regional Science}
  \index{spatial econometrics!history of}
  \index{regionalisation}
  \index{functional region}

Economic planning was widespread in Europe at the time, and was also
central in the development of Regional Science, in particular input-output
models; as @boyce:04 recounts, Walter Isard worked closely with
Wassily Leontief. Operational and planning motivations for applied
economics were unquestioned, as economists in the post-war period saw
their role, beyond educating young economists, as providing rational
foundations for economic policy. It is worth noting that Jean Paelinck
participated actively in the Association de Science Régionale De Langue
Française, becoming president in 1973--1976. The first president of
the association was François Perroux, who had founded it with Walter
Isard in 1961 [@baillyetal:12].
  \index{input-output model}
  \index{Regional Science}

Until the 1980s, it was not at all unusual to publish original
results in other languages than English. French spatial economic
research, for example @ponsard:83, while making little impact
in Anglophone countries, was widely used in teaching and research
elsewhere [@billot+thisse:92]. They contrast, though, the "word
wizardry of François Perroux with the rigour of Claude Ponsard"
@billot+thisse:92 [p. 194], echoing the views expressed by
@dreze:64 [pp. 3--4] with regard to the work of Perroux. Even
if we accept that "word wizardry" deserves more rigour and recasting
in normative and empirically testable forms, it is also part of the
context within which spatial econometrics came into being. A reading of
@perroux:50 [a lecture given at Harvard University] is worthwhile,
because it not only gives the reader a vignette of the context in
the post-war period, but also provides a discussion of economic space,
as opposed to "banal, unreflected space, mere position", that has
largely disappeared from our considerations.
  \index{Regional Science}
  \index{space economy}

The title of the journal: *Regional and Urban Economics,
Operational Methods*, founded by Jean Paelinck in 1971, and which
was renamed as *Regional Science and Urban Economics* in 1975.
@boyce:04 [p. 43], points to the perceived importance of
"operational methods", a version of the term "operational theory
and method" used in the title of @paelinck+nijkamp:75. Spatial
econometrics does not seem to have come into being as a set of estimation
techniques as such, as perhaps we might think today, but rather as
an approach addressing open research questions both in space economy
and in the enhancement of interregional models to be used in offering
policy advice.
  \index{Regional Science}
  \index{spatial econometrics!history of}

Were motivations of this kind common during the 1960s and early
1970s? Not only was the spread of Regional Science extensive and
firmly established [@boyce:04], but public bodies were concerned
to regionalise economic measurement and policy advice [see,
for example @graham+romans:71]. In Britain, *Environment
and Planning* was started in 1969 with Alan Wilson as founding
editor and published by Pion; he was assistant director at the
Centre for Environmental Studies at this time before moving to
the University of Leeds. In a recently published lecture series,
@wilson:12 [pp. 35-36] cites @paelinck+nijkamp:75 as
giving principles for contributions from economics to urban and regional
analysis [see also @wilson:00, p. 34].  The papers presented at
annual Regional Science meetings were published in a series by Pion; the
first number in the series included contributions by @granger:69
and @cliff+ord:69.
  \index{Regional Science}
  \index{spatial econometrics!history of}
  \index{economic measurement}

In a contribution to a panel session at the 2006 annual meeting of
the American Association of Geographers (co-panelists Luc Anselin
and Daniel Griffith), Keith Ord pointed to the continued relevance
of Granger's remarks at the meeting almost fourty years earlier
[@ord:10, pp. 168-169]; we will return to these concerns below. As
noted by @bivand:08 [pp. 1--5], communities of researchers working
in and near mathematical and theoretical geography was more integrated
in the pre-internet and pre-photocopier age than one might expect, with
duplicated working papers prepared using stencils circulating rapidly
between collaborating academic centres. Knowledge of the preliminary
results of other researchers then fed through into rapid innovation
in an exciting climate for those with access to these meetings and
working papers.

There was considerable overlap between quantitative geography and
regional science, so that work like @cliff+ord:69 is cited by
@hordijk:74, and was certainly known at the Netherlands Economic
Institute several years earlier. Although it has not been possible
to find out who participated in the August 1968 conference of the
British and Irish Section of the Regional Science Association at which
@cliff+ord:69 was read, it was not unusual for members of other
sections to be present, and to return home with bundles of duplicated
papers. Up to the 1990s, presenters at conferences handed out copies of
their papers, and conference participants posted home parcels of these
hand-outs, indexed using the conference programme.
  \index{Regional Science}
  \index{quantitative geography}

Leslie Hepple was among the more thorough scholars working on the
underpinnings of spatial econometrics prior to the publication of
@paelinck+klaassen:79. His wide-ranging review @hepple:74
is cited by @bartels+hordijk:77, again demonstrating the close
links between those working in this field. We will be returning to
the review paper, and to @hepple:76, which studies methods of
estimation for spatial econometrics models in some depth, building on
and extending @ord:75.
  \index{Regional Science}
  \index{spatial econometrics!history of}
  \index{quantitative geography}

@hepple:74, like @cliff+ord:73, saw no distinction between
spatial statistics and the antecedents to spatial econometrics. Obviously,
spatial econometrics was strongly influenced by the research tasks
undertaken by regional and urban economists and regional scientists. As
@griffith+paelinck:07 [p. 211] point out, spatial statistics and
spatial econometrics continue to share most topics of interests, with each
also possessing shorter lists of topics that have been of less concern to
the other. They advocate a "non-standard" spatial econometrics, which
is inclusive to wider concerns. It seems appropriate in this context to
mention the somewhat heterodox position taken by @mcmillen:10,
who draws attention to the crucial issue of functional form, which he
argues may well lie behind observed spatial autocorrelation; we will
return to this in later chapters.
  \index{spatial econometrics!history of}
  \index{spatial statistics}

## Economic and social research questions using spatial data {#sec-why-econ-soc}

In their critical appraisal of spatial econometrics, @gibbons+overman:12
state that:

> In many (micro) economic fields—particularly development, education,
environment, labor, health, and public finance—empirical work is
increasingly concerned with questions about causality ... If we increase
an individual’s years of education, what happens to their wages? If we
decrease class sizes, what happens to student grades? These questions
are fundamentally of the type 'if we change x, what do we expect to
happen to y.' Just as with economics more generally, such questions are
fundamental to our understanding of spatial economics [@gibbons+overman:12,
p. 172-173].

In the years preceding their description of spatial econometrics
risking becoming *mostly pointless*, practicioners had been realising
that interpretation of model output was not as simple as had been
assumed. In aspatial models, there is no spatial spillover to consider,
and in time-series models, only past observations can influence
the present. However, in spatial autoregressive models using for
example the average of neighbours' values of the dependent variable
as an explanatory variable, the coefficient of the spatially lagged
dependent variable interacts with the coefficients of the independent
variables [@kelejianetal:06; @lesage+fischer:08; @ward+gleditsch:08;
@lesage+pace:09]. The correct interpretation of the estimated
coefficients of models using spatial data is, naturally, central to
exploring "'if we change x, what do we expect to happen to y.'" See
also @corrado+fingleton:12 for further discussion of the importance of
thinking of spatial econometric models as tools for studying causality
as understood at that time.
  \index{spatial econometrics}
  \index{spatial econometrics models! interpretation}
  \index{spatial lag}
  \index{causality}

A further, associated, bundle of strands of development in spatial
econometrics following 2010 also involved causality. @delgado+florax:15
draw on @rubin:74; @rubin:78 to highlight the risk posed to the
stable unit treatment value assumption (SUTVA) by unmodelled spatial
dependency in the data. This key assumption for causal alaysis "implies
that potential outcomes for person $i$ are unrelated to the treatment
status of other individuals" [@angristetal:96]. The assumption and the
risk of its violation when spatial data is modelled aspatially is also
discussed at that time by @koschinsky:13 and @baylis+ham:15.
  \index{causality}
  \index{causality! SUTVA}

Work by @delgado+florax:15 has been followed up by @bardakaetal:18 and
@bardakaetal:19, showing practically how a difference-in-difference (DID)
econometric design measuring the impact of change on a chosen dependent
variable. @dubeetal:14 approach spatial difference-in-difference in a
similar way, followed up in @dubeetal:17 and @dubeetal:21. @bardakaetal:18
express the two approaches:

> Spatial DID models have been proposed by Dubé et al. (2014) and
Delgado and Florax (2015); Delgado and Florax (2015) focus on violations
of SUTVA in the case of spillover eﬀects local to the treatment whereas
Dubé et al. (2014) focus on global eﬀects [@bardakaetal:18, p. 17].

@dubeetal:14 and work derived from this, such as @sunak+madlener:16
and @diaoetal:17, has been referred to directly and indirectly by an
increasing number of applied studies, including @fang:21, @jiaetal:21,
@qiu+tong:21, @liuetal:22, @chenetal:23, @gao+wang:23, @panetal:23,
@yu+jin:23 and @zengetal:23. Some refer to both spatial DID origins:
@chagasetal:16 and @qiu+tong:21, while some derive from @delgado+florax:15
alone: @hanetal:18 and @kosfeldetal:21. It is clear that the demand for
assessments of the consequences of for example infrastructure investments
on house prices or environmental measures is enormous, so it is likely
that such studies will continue to proliferate. Both @dubeetal:14
and @delgado+florax:15 presuppose that applied researchers using their
approaches are adequately trained in spatial econometrics, so that these
researchers are more than familiar with the spatial extensions to aspatial
econometric techniques. These spatial extensions are the core of our book.
  \index{difference-in-difference}
  \index{difference-in-difference! spatial}
  \index{spatial difference-in-difference|see {difference-in-difference, spatial}}

Before continuing to present the structure of this book, it is also
sensible to cover three "breaking" topics related to causality in a
spatial context. The first of the "breaking" topics extends regression
discontinuity designs, from discussion in @gibbonsetal:13 through
@calonicoetal:14 and @keele+titiunik:15 to @butts:23 and @butts:23b,
with @cattaneo+titiunik:22 as an up-to-date general review. While
neither @dubeetal:14 nor @delgado+florax:15 appear to be directly
backed by software, software packages for R, Python and Stata for
work by Sebastian Calonico, Matias D. Cattaneo and Rocío Titiunik is
[published](https://rdpackages.github.io/); ongoing work by [Kyle
Butts](https://github.com/kylebutts) is also available.
  \index{regression discontinuity design}

The second two "breaking" topics relate directly to @olsson:70, in
which he addressed the question of the extent to which prediction and
explanation could be seen as symmetric. Summarising his findings, Olsson
asserted that:

> ... an adequate explanation may lead to a successful prediction,
but ... successful prediction is not the same as successful
explanation. [@olsson:70, p. 230]

This relates directly to: "'if we change x, what do we expect to happen
to y'", which is more about explanation (and hence causality) than
prediction. Many contemporary quantitative methods utilise predictive
success to attempt to improve model fit, and having achieved predictive
success try to re-construct the meaning of the output model in order to
work back to explanation.

Secondly, three important surveys of causality in spatial data analysis have
appeared recently: @kolak+anselin:20, @gaoetal:22, and @akbarietal:23. All
of these take up spatial challenges to the stable unit treatment value
assumption, @kolak+anselin:20 with an example of the impact of changes in
minimum legal drinking age laws on mortality for US states. @gaoetal:22
point to the rapid extension of spatial statistics to other knowledge
domains including bioinformatics, in which causal inference is clearly
important. The main use cases considered by @akbarietal:23 are in spatial
cognition, including wayfinding processes and navigation systems, because
these are so much broader in impact than program evaluations. Because
@akbarietal:23 is a literature review, it does not propose methods, but
describes those available. They also comment that of the minority of
articles included in the review that reported what software was used,
the most commonly used software was R. Only 12 percent of the articles
cited code needed to reproduce their results [see also @wolf:23]. They 
comment:
  \index{causality}
  \index{causality! SUTVA}
  \index{reproducible research}

>  This low rate of accessibility to code is a big challenge that not
only limits reproducibility of the reviewed papers, but also affects the
portability and translation of approaches to other case studies in spatial
causal inference. ... In sum, in most of the reviewed research, there
are no clear procedures related to reproducibility and validation. We
can trust more the results of papers with straightforward approaches
with a sufficient level of details. [@akbarietal:23, p. 79]

The final "breaking" topic is the influence of spatial autocorrelation
on machine learning, statistical learning, and convolutional neural
networks. @kattenbornetal:22 study the impact of spatial autocorrelation
on the training of convolutional neural networks for data acquired by
drones, and find:
  \index{machine learning}
  \index{artificial intelligence}

> Our results suggest that violating spatial independence between
training and test data can severely inflate model apparent performance
(up to almost 30%) and, hence, lead to an overly optimistic evaluation
of the generalization of such models. [@kattenbornetal:22, p. 7]

This observation, that the violation of the assumption of spatial
independence between training, validation and test data sets prejudices
outcomes, has been recognised in much of spatial data science for years,
at least from @brenning:12. There is now an extensive literature both on
the split between training and test data sets, and on the use of fitted
models for prediction to areas that were un- or under-represented in the
data used to fit the model [@meyeretal:18; @valavietal:19; @meyeretal:19;
@schratzetal:19; @meyer+pebesma:21; @milaetal:22; @meyer+pebesma:22;
@linnenbrinketal:23]. These articles are accompanied by software
permitting the reproduction of their findings and the application of
suggested adaptations, replacing random permutations in machine learning
model fitting and tuning by spatially-aware procedures.
  \index{spatial autocorrelation}
  \index{cross-validation, spatial}
  \index{machine learning}

@kopczewska:22 summarises the current research position with regard to
spatial data use in machine learning in this way:
  \index{machine learning}
  \index{spatial autocorrelation}

> It is clear from many studies that unaddressed spatial autocorrelation
generates problems, such as overoptimistic fit of models, omitted
information and/or biased (suboptimal) prediction. Thus, an up-to-date
toolbox dealing with spatial autocorrelation should be used in all ML
models in order to ensure methodological appropriateness. [@kopczewska:22,
p. 732]

She does, however, provide encouraging examples of the spatially-informed
use of machine learning methods, and a concise overview of concepts
and a listing of relevant R packages in two appendices [@kopczewska:22,
pp. 735--749].
  \index{machine learning! spatial}
  \index{reproducible research}

@wagner+zeileis:19 use model-based recursive partitioning handling
the spatial dependencies by including the spatially lagged dependent
variable in a spatial econometric model to study heterogeneous
growth. @vidolietal22 approach heterogeneity through spatial regimes,
as do @piras+sarrias:23; all three articles are backed by software.
  \index{machine learning! spatial}
  \index{spatial lag}
  \index{spatial regimes}

@nikparvar+thill:21 give a broad review of machine learning methods
and applications to spatial data, including attention to spatial
autocorrelation, spatial scale and spatial heterogeneity. @credit:22
considers the intersection of random forest models - a machine learning
method aggregating the outout of many decision trees - and spatial
econometrics models. In addition to the inclusion of the spatially lagged
dependent variable [@wagner+zeileis:19], spatially lagged independent
variables were considered. @yosidaetal:22 compare a selection of
spatially-aware machine learning approaches and a nearest-neighbour
Gaussian process model for predicting apartment rents, following some of
the suggestions made by @credit:22; references to software are provided.
  \index{machine learning! spatial}
  \index{machine learning}
  \index{random forest model}

Consideration of machine learning and the application of deep
learning/neural networks overlaps in a fair number of cases, raising
similar concerns about how the probable lack of independence between
proximate observations in space will be handled. @ahmedetal:21 stress
the need for interpretability and explainability in deep learning/neural
networks (also known as artificial intelligence) as well as in machine
learning, and explore model agnostic greedy explanations of model
predictions; references to software are provided.
  \index{deep learning}
  \index{artificial intelligence}

@zhangetal:22 and @dengetal:23 also focus on interpretability of machine
learning methods for predicting crime risk; @dengetal:23 provide their
complete data set. @zhuetal:22 [minor correction @zhuetal:23] propose
spatial regression graph convolutional neural networks for modelling and
predicting multivariate spatial data, also considering what is known as
feature selection (or engineering), which is related to interpretability;
references to software are provided.
  \index{spatial regression model}
  \index{deep learning}

@lietal:23, like @credit:22, introduce the spatially lagged dependent
variable (whether a manhole in an urban drainage system overflows or
not) into a deep neural network model. @xiaoetal:23 and @wang+song:23
in two articles with overlapping authorships look more closely at
integrating adaptations of classical spatial econometrics models -
spatial autoregressive models - into deep neural network models, both
making nonparametric additions to the classical models.
  \index{spatial regression model}
  \index{deep learning}
  \index{artificial intelligence}

The literatures covering the interpretation of spatial econometric
models, causality when the data used are spatial and so challenge standard
econometric assumptions, and training/test set data splits affecting
machine learning and artificial intelligence applications, are all
burgeoning. It might be thought that the superficial mentioning of these
questions in this section should direct us to focus attention in this book
on emerging research opportunities. However, our reading of contributions
to the current literature, taken with readings of the many other articles
published since 2020 - @dubeetal:14 has been cited hundreds of times,
mostly since 2020 - suggests that many authors would benefit substantially
from a clearer grasp of the background to spatial econometric models,
and many of their internal characteristcs. Hence, based in part on this
motivation, we will now move to present the structure of this book.


## Tests of spatial autocorrelation, model specification

## Spatial autoregressive models: conditional (CAR) and simultaneous (SAR)



<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Spatial Econometrics - 10&nbsp; No orthogonality between regression and autoregression coefficients</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11_talk.html" rel="next">
<link href="./09_talk.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10_talk.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">No orthogonality between regression and autoregression coefficients</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatial Econometrics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course description</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducing Spatial Econometrics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spatial data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Working with spatial data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating spatial weights objects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Antecedents</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Economic and social research questions using spatial data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tests of spatial autocorrelation, model specification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Spatial autoregressive models: conditional (CAR) and simultaneous (SAR)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation of spatial autoregressive models: methods (ML, Bayesian, GMM)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_talk.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">No orthogonality between regression and autoregression coefficients</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Prediction and spatial models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_talk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Eigenvectors and eigenvalues of graphs of relationships between cross-sectional observations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#marginal-effects-in-spatial-econometrics" id="toc-marginal-effects-in-spatial-econometrics" class="nav-link active" data-scroll-target="#marginal-effects-in-spatial-econometrics"><span class="header-section-number">10.1</span> Marginal effects in spatial econometrics</a></li>
  <li><a href="#trace-style-impacts" id="toc-trace-style-impacts" class="nav-link" data-scroll-target="#trace-style-impacts"><span class="header-section-number">10.2</span> Trace-style impacts</a></li>
  <li><a href="#bayesian-marginal-effects" id="toc-bayesian-marginal-effects" class="nav-link" data-scroll-target="#bayesian-marginal-effects"><span class="header-section-number">10.3</span> Bayesian marginal effects</a></li>
  <li><a href="#gmm-marginal-effects" id="toc-gmm-marginal-effects" class="nav-link" data-scroll-target="#gmm-marginal-effects"><span class="header-section-number">10.4</span> GMM marginal effects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">No orthogonality between regression and autoregression coefficients</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="marginal-effects-in-spatial-econometrics" class="level2" data-number="10.1">
<h2 data-number="10.1" data-anchor-id="marginal-effects-in-spatial-econometrics"><span class="header-section-number">10.1</span> Marginal effects in spatial econometrics</h2>
<p>Recall that we aim to consider:</p>
<blockquote class="blockquote">
<p>if we change x, what do we expect to happen to y.</p>
</blockquote>
<p>It has emerged over time, however, that the spatial dependence in the parameter <span class="math inline">\rho_{\mathrm{Lag}}</span> feeds back. This feedback comes from the fact that the reduced form model is <span class="math inline">{\mathbf y} = ({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1}{\mathbf X}{\mathbf \beta} + ({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1}{\mathbf \varepsilon}</span>. <span class="math inline">{\mathbf I}</span> is the <span class="math inline">n \times n</span> identity matrix, and <span class="math inline">({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1}</span> is known to be dense. Expressed in terms of changes in <span class="math inline">x</span> impacting <span class="math inline">y</span>, the feedback runs through the global spillover <span class="math inline">({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1}</span>. These difficulties are discussed as emanating effects <span class="citation" data-cites="kelejianetal:06">(<a href="references.html#ref-kelejianetal:06" role="doc-biblioref">Kelejian, Tavlas, and Hondroyiannis 2006</a>)</span>, also known as impacts <span class="citation" data-cites="lesage+fischer:08 lesage+pace:09 golgher+voss:16">(<a href="references.html#ref-lesage+fischer:08" role="doc-biblioref">LeSage and Fischer 2008</a>; <a href="references.html#ref-lesage+pace:09" role="doc-biblioref">LeSage and Pace 2009</a>; <a href="references.html#ref-golgher+voss:16" role="doc-biblioref">Golgher and Voss 2016</a>)</span>, simultaneous spatial reaction function/reduced form <span class="citation" data-cites="anselin+lozano-gracia:08">(<a href="references.html#ref-anselin+lozano-gracia:08" role="doc-biblioref">Anselin and Lozano-Gracia 2008</a>)</span> and equilibrium effects <span class="citation" data-cites="ward+gleditsch:08">(<a href="references.html#ref-ward+gleditsch:08" role="doc-biblioref">Ward and Gleditsch 2008</a>)</span>.</p>
<p>This feedback comes from the fact that, while the elements of the Hessian matrix for the ML spatial error model linking <span class="math inline">\rho_{\mathrm{Err}}</span> and <span class="math inline">\beta</span> are zero (<span class="math inline">\partial^2 \ell / (\partial \beta \partial \rho_{\mathrm{Err}}) = {\mathbf 0}</span>), in the spatial lag model (and by extension in the spatial Durbin model): <span class="math inline">\partial^2 \ell / (\partial \beta \partial \rho_{\mathrm{Lag}}) \neq {\mathbf 0}</span>. In the spatial error model, for exogenous variable <span class="math inline">r</span>, <span class="math inline">\partial y_i / \partial x_{ir} = \beta_r</span> and <span class="math inline">\partial y_i / \partial x_{jr} = 0</span> for <span class="math inline">i \neq j</span>. In the spatial lag model, <span class="math inline">\partial y_i / \partial x_{jr} = (({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1} {\mathbf I} \beta_r)_{ij}</span>, where <span class="math inline">{\mathbf I}</span> is the <span class="math inline">n \times n</span> identity matrix. The awkward <span class="math inline">S_r({\mathbf W}) = (({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1} {\mathbf I} \beta_r)</span> matrix term needed to calculate impact measures for the lag model, and <span class="math inline">S_r({\mathbf W}) = (({\mathbf I} - \rho_{\mathrm{Lag}} {\mathbf W})^{-1} ({\mathbf I} \beta_r - {\mathbf W} \gamma_r))</span> for the spatial Durbin model, may be approximated using traces of powers of the spatial weights matrix as well as analytically.</p>
<p>The average direct impacts are represented by the sum of the diagonal elements of the matrix divided by <span class="math inline">n</span> for each exogenous variable. The average total impacts are the sum of all matrix elements divided by <span class="math inline">n</span> for each exogenous variable. The average indirect impacts are the differences between the direct and total impact vectors.</p>
<p>The development in LeSage and Pace (2009, pp.&nbsp;114–115) for the SLM model and <span class="math inline">q</span> traces (traces are sums of values on the principal diagonal) is as follows:</p>
<p><span class="math display">
{\mathbf T} = [1, 0, n^{-1}tr({\mathbf W}^2), n^{-1}tr({\mathbf W}^3), \ldots, n^{-1}tr({\mathbf W}^q)]
</span></p>
<p><span class="math display">
{\mathbf g} = [1, \rho, \rho^2, \rho^3, \ldots, \rho^q]; {\mathbf G}_{ii} = g_i, i = 1, \ldots, q+1
</span></p>
<p><span class="math display">
{\mathbf P} = [\beta_1, \beta_2, \ldots, \beta_p]^T
</span></p>
<p>where the intercept <span class="math inline">\beta_0</span> is dropped, and with <span class="math inline">{\mathbf a}</span> a <span class="math inline">p</span>-vector of ones:</p>
<p><span class="math display">
{\mathrm {Direct}} = {\mathbf P} {\mathbf T} {\mathbf G} {\mathbf a}
</span></p>
<p><span class="math display">
{\mathrm {Total}} = {\mathbf \beta} {\mathbf g} {\mathbf a}
</span></p>
</section>
<section id="trace-style-impacts" class="level2" data-number="10.2">
<h2 data-number="10.2" data-anchor-id="trace-style-impacts"><span class="header-section-number">10.2</span> Trace-style impacts</h2>
<p><code>trW</code> in <code>spatialreg</code> can be used to generate <span class="math inline">{\mathbf T}</span> above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(unb, <span class="at">style=</span><span class="st">"W"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spatialreg)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">eigenw</span>(lw)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">as</span>(lw, <span class="st">"CsparseMatrix"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>trMat <span class="ot">&lt;-</span> <span class="fu">trW</span>(W, <span class="at">type=</span><span class="st">"mult"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>SLM_pre_maj <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(form_pre_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">control=</span><span class="fu">list</span>(<span class="at">pre_eig=</span>e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The samples are drawn from the fitted model using the coefficients, spatial lag coefficient <span class="math inline">\rho_{\mathrm{Lag}}</span> and possibly other components as the mean values, and the variance-covariance matrix of coefficients, applying <code>mvrnorm</code> from <code>MASS</code> once for <code>R</code> draws, yielding inputs for the trace method, which is applied to each draw to give <code>R</code> sample direct, indirect and total impacts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>(imp_SLM_pre_maj_tr <span class="ot">&lt;-</span> <span class="fu">impacts</span>(SLM_pre_maj, <span class="at">tr=</span>trMat, <span class="at">R=</span>R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
                    Direct     Indirect       Total
log(units)      0.97021645  0.166102763  1.13631922
house          -1.75150349 -0.299860477 -2.05136397
log(dens)      -0.02019100 -0.003456735 -0.02364774
Metroplondon    0.07432424  0.012724440  0.08704868
Metropmetrop   -0.05080358 -0.008697662 -0.05950124
log(realWgPre)  0.34764203  0.059516927  0.40715896
MajorityCONS    0.03796509  0.006499690  0.04446478
MajorityLAB     0.19524091  0.033425587  0.22866650</code></pre>
</div>
</div>
<p>Repeating for post-CCT, we have <code>R</code> pre-CCT samples of <span class="math inline">\rho_{\mathrm{Lag}}</span>, and <code>R</code> post-CCT samples, plus the same counts of sample impacts for the variables distinguished in <span class="citation" data-cites="bivand+szymanski:00">Bivand and Szymanski (<a href="references.html#ref-bivand+szymanski:00" role="doc-biblioref">2000</a>)</span> as of importance both pre-CCT and post-CCT.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>SLM_post_maj <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(form_post_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">control=</span><span class="fu">list</span>(<span class="at">pre_eig=</span>e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>(imp_SLM_post_maj_tr <span class="ot">&lt;-</span> <span class="fu">impacts</span>(SLM_post_maj, <span class="at">tr=</span>trMat, <span class="at">R=</span>R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Impact measures (lag, trace):
                    Direct     Indirect       Total
log(units)      0.93758286  0.133550323  1.07113319
house          -1.37901113 -0.196427845 -1.57543897
log(dens)      -0.04950261 -0.007051205 -0.05655381
Metroplondon    0.03621620  0.005158675  0.04137488
Metropmetrop   -0.02805200 -0.003995758 -0.03204776
log(realWgPst)  0.67442535  0.096065881  0.77049124
MajorityCONS   -0.01960548 -0.002792626 -0.02239811
MajorityLAB     0.17957971  0.025579529  0.20515924</code></pre>
</div>
</div>
<p>As a graphical display may be easier to begin with, we’ll use <code>tinyplot</code> and assemble the samples of <span class="math inline">\rho_{\mathrm{Lag}}</span>, and the total impact samples for the variables: logarithm of pick-up point counts, proportion of dwellings among pick-up points, logarithm of density of pick-up points per unit area, logarithm of real wages, and the categorical variable Labour majority control (compared with base value of no overall control).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pre_samp <span class="ot">&lt;-</span> <span class="fu">attr</span>(imp_SLM_pre_maj_tr, <span class="st">"samples"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>post_samp <span class="ot">&lt;-</span> <span class="fu">attr</span>(imp_SLM_post_maj_tr, <span class="st">"samples"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pre_tot <span class="ot">&lt;-</span> imp_SLM_pre_maj_tr<span class="sc">$</span>sres<span class="sc">$</span>total[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>post_tot <span class="ot">&lt;-</span> imp_SLM_post_maj_tr<span class="sc">$</span>sres<span class="sc">$</span>total[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(pre_tot, post_tot))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tot)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log.realWg."</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tot, <span class="at">rho=</span><span class="fu">c</span>(pre_samp<span class="sc">$</span>samples[,<span class="dv">2</span>], post_samp<span class="sc">$</span>samples[,<span class="dv">2</span>]), <span class="at">CCT=</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"pre"</span>, <span class="at">times=</span>R), <span class="fu">rep</span>(<span class="st">"post"</span>, <span class="at">times=</span>R)), <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We expect see the total impacts of the logarithm of density of pick-up points per unit area and those of the logarithm of real wages sharpen (move further from zero) as CCT leads to increased efficiency. An increase in efficiency might also be associated with moves toward zero of the other three variables. In <span class="citation" data-cites="bivand+szymanski:00">Bivand and Szymanski (<a href="references.html#ref-bivand+szymanski:00" role="doc-biblioref">2000</a>)</span>, we also asserted that <span class="math inline">\rho_{\mathrm{Lag}}</span> would move towards zero as yardstick competition was replaced by competitive tendering.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinyplot)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> rho <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"rho"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.units. <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(units)"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> house <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"house"</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.dens. <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(dens)"</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.realWg. <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(realWg)"</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>g5 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> MajorityLAB <span class="sc">|</span> CCT, <span class="at">data=</span>df, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"MajorityLAB"</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>g6 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"Images/10_imp_pre_post_tr_fig0.png"</span>, <span class="at">width=</span><span class="dv">760</span>, <span class="at">height=</span><span class="dv">1200</span>, <span class="at">pointsize=</span><span class="dv">10</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g1, g2, g3, g4, g5, g6, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/10_imp_pre_post_tr_fig0.png" style="width:100.0%" class="figure-img"></p>
<figcaption>Shifts in spatial coefficient value and chosen variable total impacts from pre-CCT to post-CCT, SLM models, 324 English districts</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also use <code>tinytable</code> to show the estimates of <span class="math inline">\rho_{\mathrm{Lag}}</span> and total imacts for the selected variables with their standard errors (for the impacts, standard errors estimated from the samples):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytable)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sum_imp_SLM_pre_maj_tr <span class="ot">&lt;-</span> <span class="fu">summary</span>(imp_SLM_pre_maj_tr, <span class="at">short=</span><span class="cn">TRUE</span>, <span class="at">zstats=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>sum_imp_SLM_post_maj_tr <span class="ot">&lt;-</span> <span class="fu">summary</span>(imp_SLM_post_maj_tr, <span class="at">short=</span><span class="cn">TRUE</span>, <span class="at">zstats=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>tf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable=</span><span class="fu">c</span>(<span class="fu">attr</span>(imp_SLM_pre_maj_tr, <span class="st">"bnames"</span>)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)], <span class="st">"rho"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pre=</span><span class="fu">c</span>(sum_imp_SLM_pre_maj_tr<span class="sc">$</span>res<span class="sc">$</span>total[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)], SLM_pre_maj<span class="sc">$</span>rho),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pre_se=</span><span class="fu">c</span>(sum_imp_SLM_pre_maj_tr<span class="sc">$</span>semat[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], SLM_pre_maj<span class="sc">$</span>rho.se),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">post=</span><span class="fu">c</span>(sum_imp_SLM_post_maj_tr<span class="sc">$</span>res<span class="sc">$</span>total[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)], SLM_post_maj<span class="sc">$</span>rho),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">post_se=</span><span class="fu">c</span>(sum_imp_SLM_post_maj_tr<span class="sc">$</span>semat[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], SLM_post_maj<span class="sc">$</span>rho.se))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>tf<span class="sc">$</span>variable[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log(realWg)"</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tt</span>(tf, <span class="at">digits=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_x7thj6a1p3jqq0ljqkme</title>
    <style>
.table td.tinytable_css_q8xwwa3tp9lg6fzewsdz, .table th.tinytable_css_q8xwwa3tp9lg6fzewsdz {    border-bottom: solid 0.1em #d3d8dc; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_x7thj6a1p3jqq0ljqkme" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">variable</th>
                <th scope="col">pre</th>
                <th scope="col">pre_se</th>
                <th scope="col">post</th>
                <th scope="col">post_se</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>log(units) </td>
                  <td> 1.13632</td>
                  <td>0.07465</td>
                  <td> 1.07113</td>
                  <td>0.06949</td>
                </tr>
                <tr>
                  <td>house      </td>
                  <td>-2.05136</td>
                  <td>0.36659</td>
                  <td>-1.57544</td>
                  <td>0.33305</td>
                </tr>
                <tr>
                  <td>log(dens)  </td>
                  <td>-0.02365</td>
                  <td>0.01477</td>
                  <td>-0.05655</td>
                  <td>0.01389</td>
                </tr>
                <tr>
                  <td>log(realWg)</td>
                  <td> 0.40716</td>
                  <td>0.25623</td>
                  <td> 0.77049</td>
                  <td>0.21888</td>
                </tr>
                <tr>
                  <td>MajorityLAB</td>
                  <td> 0.22867</td>
                  <td>0.04353</td>
                  <td> 0.20516</td>
                  <td>0.04111</td>
                </tr>
                <tr>
                  <td>rho        </td>
                  <td> 0.1504 </td>
                  <td>0.04404</td>
                  <td> 0.12778</td>
                  <td>0.04532</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_8jjt2ivg0yv7uix1ejez(i, j, css_id) {
        var table = document.getElementById("tinytable_x7thj6a1p3jqq0ljqkme");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_x7thj6a1p3jqq0ljqkme');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_8jjt2ivg0yv7uix1ejez(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_x7thj6a1p3jqq0ljqkme");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_8jjt2ivg0yv7uix1ejez(0, 0, 'tinytable_css_q8xwwa3tp9lg6fzewsdz') })
window.addEventListener('load', function () { styleCell_tinytable_8jjt2ivg0yv7uix1ejez(0, 1, 'tinytable_css_q8xwwa3tp9lg6fzewsdz') })
window.addEventListener('load', function () { styleCell_tinytable_8jjt2ivg0yv7uix1ejez(0, 2, 'tinytable_css_q8xwwa3tp9lg6fzewsdz') })
window.addEventListener('load', function () { styleCell_tinytable_8jjt2ivg0yv7uix1ejez(0, 3, 'tinytable_css_q8xwwa3tp9lg6fzewsdz') })
window.addEventListener('load', function () { styleCell_tinytable_8jjt2ivg0yv7uix1ejez(0, 4, 'tinytable_css_q8xwwa3tp9lg6fzewsdz') })
    </script>

  


</div>
</div>
</section>
<section id="bayesian-marginal-effects" class="level2" data-number="10.3">
<h2 data-number="10.3" data-anchor-id="bayesian-marginal-effects"><span class="header-section-number">10.3</span> Bayesian marginal effects</h2>
<p>Because MCMC in any case draws samples, the use of fitted coefficients and their covariance matrix for posterior sampling to carry out inference on the models is unnecessary, and the same trace method can be used as with other estimation methods for constructing the sample impacts. Here we thin the samples to reduce the time needed for plotting the density plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>SLM_pre_maj_bayes <span class="ot">&lt;-</span> <span class="fu">spBreg_lag</span>(form_pre_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">control=</span><span class="fu">list</span>(<span class="at">ndraw=</span><span class="dv">22000</span>L, <span class="at">nomit=</span><span class="dv">2000</span>L, <span class="at">thin=</span><span class="dv">10</span>L))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>SLM_post_maj_bayes <span class="ot">&lt;-</span> <span class="fu">spBreg_lag</span>(form_post_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">control=</span><span class="fu">list</span>(<span class="at">ndraw=</span><span class="dv">22000</span>L, <span class="at">nomit=</span><span class="dv">2000</span>L, <span class="at">thin=</span><span class="dv">10</span>L))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As can be seen, no <code>R</code> is needed to give the number of samples to draw, because they are already at hand. If we wished to modify the priors of the Bayesian models, we could also explore the consequences for the impacts - here uninformative priors have been used, yielding results very like those of maximum likelihood:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sum_imp_pre <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">impacts</span>(SLM_pre_maj_bayes, <span class="at">tr=</span>trMat))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sum_imp_post <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">impacts</span>(SLM_post_maj_bayes, <span class="at">tr=</span>trMat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pre_tot <span class="ot">&lt;-</span> sum_imp_pre<span class="sc">$</span>sres<span class="sc">$</span>total[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>post_tot <span class="ot">&lt;-</span> sum_imp_post<span class="sc">$</span>sres<span class="sc">$</span>total[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">nrow</span>(pre_tot)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(pre_tot, post_tot))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tot)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log.realWg."</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>bdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tot, <span class="at">rho=</span><span class="fu">c</span>(<span class="fu">c</span>(SLM_pre_maj_bayes[, <span class="st">"rho"</span>]), <span class="fu">c</span>(SLM_post_maj_bayes[, <span class="st">"rho"</span>])), <span class="at">CCT=</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"pre"</span>, <span class="at">times=</span>R), <span class="fu">rep</span>(<span class="st">"post"</span>, <span class="at">times=</span>R)), <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"pre"</span>, <span class="st">"post"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinyplot)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> rho <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"rho"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.units. <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(units)"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> house <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"house"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.dens. <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(dens)"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> log.realWg. <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"log(realWg)"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>g5 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="fu">x11</span>()</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="fu">tinyplot</span>(<span class="sc">~</span> MajorityLAB <span class="sc">|</span> CCT, <span class="at">data=</span>bdf, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">fill=</span><span class="st">"by"</span>, <span class="at">palette=</span><span class="st">"dark2"</span>, <span class="at">main=</span><span class="st">"MajorityLAB"</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>gridGraphics<span class="sc">::</span><span class="fu">grid.echo</span>()</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>g6 <span class="ot">&lt;-</span> <span class="fu">grid.grab</span>()</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"Images/10_bayes_pre_post_tr_fig0.png"</span>, <span class="at">width=</span><span class="dv">760</span>, <span class="at">height=</span><span class="dv">1200</span>, <span class="at">pointsize=</span><span class="dv">10</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g1, g2, g3, g4, g5, g6, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Images/10_bayes_pre_post_tr_fig0.png" style="width:100.0%" class="figure-img"></p>
<figcaption>Shifts in spatial coefficient value and chosen variable total impacts from pre-CCT to post-CCT, SLM models, 324 English districts</figcaption>
</figure>
</div>
</div>
</div>
<p>We could also replicate the outcomes in tabular form.</p>
</section>
<section id="gmm-marginal-effects" class="level2" data-number="10.4">
<h2 data-number="10.4" data-anchor-id="gmm-marginal-effects"><span class="header-section-number">10.4</span> GMM marginal effects</h2>
<p><span class="citation" data-cites="piras+postiglione:22">Piras and Postiglione (<a href="references.html#ref-piras+postiglione:22" role="doc-biblioref">2022</a>)</span> propose the use of eigenvalues of the spatial weights matrix to calculate the direct, indirect and total impacts, rather than the use of traces, which are necessarily approximate as the power series is truncated. However, an argument for GMM was that it avoided the computation of eigenvalues of the spatial weights matrix, which cease to be numerically stable at large <span class="math inline">n</span> using standard or extended precision (<span class="math inline">n</span> up to 10,000 is fine). For larger <span class="math inline">n</span>, the trace method remains viable.</p>
<p>The eigenvalue method can of course also be used to calculate impacts from samples for inferential purposes, but so far only the impacts themselves are available for models fitted by maximum likelihood:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tfe0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable=</span><span class="fu">c</span>(<span class="fu">names</span>(<span class="fu">coef</span>(SLM_pre_maj))[<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>], <span class="st">"rho"</span>), <span class="at">pre=</span><span class="fu">c</span>(<span class="fu">impacts</span>(SLM_pre_maj, <span class="at">evalues=</span>e)<span class="sc">$</span>total, SLM_pre_maj<span class="sc">$</span>rho), <span class="at">post=</span><span class="fu">c</span>(<span class="fu">impacts</span>(SLM_post_maj, <span class="at">evalues=</span>e)<span class="sc">$</span>total, SLM_post_maj<span class="sc">$</span>rho))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tfe0<span class="sc">$</span>variable[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">"log(realWg)"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tt</span>(tfe0, <span class="at">digits=</span><span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_20gd4tltl5zhiqtg9fvk</title>
    <style>
.table td.tinytable_css_pyqp85ruwovxfw0rx4fk, .table th.tinytable_css_pyqp85ruwovxfw0rx4fk {    border-bottom: solid 0.1em #d3d8dc; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_20gd4tltl5zhiqtg9fvk" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">variable</th>
                <th scope="col">pre</th>
                <th scope="col">post</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>log(units)  </td>
                  <td> 1.13632</td>
                  <td> 1.07113</td>
                </tr>
                <tr>
                  <td>house       </td>
                  <td>-2.05136</td>
                  <td>-1.57544</td>
                </tr>
                <tr>
                  <td>log(dens)   </td>
                  <td>-0.02365</td>
                  <td>-0.05655</td>
                </tr>
                <tr>
                  <td>Metroplondon</td>
                  <td> 0.08705</td>
                  <td> 0.04137</td>
                </tr>
                <tr>
                  <td>Metropmetrop</td>
                  <td>-0.0595 </td>
                  <td>-0.03205</td>
                </tr>
                <tr>
                  <td>log(realWg) </td>
                  <td> 0.40716</td>
                  <td> 0.77049</td>
                </tr>
                <tr>
                  <td>MajorityCONS</td>
                  <td> 0.04446</td>
                  <td>-0.0224 </td>
                </tr>
                <tr>
                  <td>MajorityLAB </td>
                  <td> 0.22867</td>
                  <td> 0.20516</td>
                </tr>
                <tr>
                  <td>rho         </td>
                  <td> 0.1504 </td>
                  <td> 0.12778</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_7zzjgpu4voyl0ksgkj9r(i, j, css_id) {
        var table = document.getElementById("tinytable_20gd4tltl5zhiqtg9fvk");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_20gd4tltl5zhiqtg9fvk');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_7zzjgpu4voyl0ksgkj9r(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_20gd4tltl5zhiqtg9fvk");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_7zzjgpu4voyl0ksgkj9r(0, 0, 'tinytable_css_pyqp85ruwovxfw0rx4fk') })
window.addEventListener('load', function () { styleCell_tinytable_7zzjgpu4voyl0ksgkj9r(0, 1, 'tinytable_css_pyqp85ruwovxfw0rx4fk') })
window.addEventListener('load', function () { styleCell_tinytable_7zzjgpu4voyl0ksgkj9r(0, 2, 'tinytable_css_pyqp85ruwovxfw0rx4fk') })
    </script>

  


</div>
</div>
<p>Let us fit the SLM pre-CCT and post-CCT models with GMM:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sphet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'sphet'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:spatialreg':

    impacts</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>spreg_pre_maj <span class="ot">&lt;-</span> <span class="fu">spreg</span>(form_pre_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">model=</span><span class="st">"lag"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>spreg_post_maj <span class="ot">&lt;-</span> <span class="fu">spreg</span>(form_post_maj, <span class="at">data=</span>eng324, <span class="at">listw=</span>lw, <span class="at">model=</span><span class="st">"lag"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and continue to calculate the impacts and their standard errors using the Kelejian and Piras formula:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>imp_spreg_pre_maj <span class="ot">&lt;-</span> <span class="fu">impacts</span>(spreg_pre_maj, <span class="at">evalues=</span>e, <span class="at">KPformula=</span><span class="cn">TRUE</span>, <span class="at">prt=</span><span class="cn">FALSE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>imp_spreg_post_maj <span class="ot">&lt;-</span> <span class="fu">impacts</span>(spreg_post_maj, <span class="at">evalues=</span>e, <span class="at">KPformula=</span><span class="cn">TRUE</span>, <span class="at">prt=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>etf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable=</span><span class="fu">c</span>(<span class="fu">rownames</span>(imp_spreg_pre_maj[[<span class="dv">1</span>]])[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>)], <span class="st">"rho"</span>),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a> <span class="at">pre=</span><span class="fu">c</span>(imp_spreg_pre_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_pre_maj)[<span class="dv">10</span>])),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> <span class="at">pre_se=</span><span class="fu">c</span>(imp_spreg_pre_maj[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">sqrt</span>(<span class="fu">diag</span>(spreg_pre_maj<span class="sc">$</span>var))[<span class="dv">10</span>]),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a> <span class="at">post=</span><span class="fu">c</span>(imp_spreg_post_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_post_maj)[<span class="dv">10</span>])),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a> <span class="at">post_se=</span><span class="fu">c</span>(imp_spreg_post_maj[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">sqrt</span>(<span class="fu">diag</span>(spreg_post_maj<span class="sc">$</span>var))[<span class="dv">10</span>]))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>etf<span class="sc">$</span>variable[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log(realWg)"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tt</span>(etf, <span class="at">digits=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_9ycn73uys0882ngj5dl5</title>
    <style>
.table td.tinytable_css_dz6i3hf81w7f5cil5u7s, .table th.tinytable_css_dz6i3hf81w7f5cil5u7s {    border-bottom: solid 0.1em #d3d8dc; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_9ycn73uys0882ngj5dl5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">variable</th>
                <th scope="col">pre</th>
                <th scope="col">pre_se</th>
                <th scope="col">post</th>
                <th scope="col">post_se</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>log(units) </td>
                  <td> 1.19098</td>
                  <td>0.09537</td>
                  <td> 1.0755 </td>
                  <td>0.08659</td>
                </tr>
                <tr>
                  <td>house      </td>
                  <td>-2.15052</td>
                  <td>0.41584</td>
                  <td>-1.58078</td>
                  <td>0.35657</td>
                </tr>
                <tr>
                  <td>log(dens)  </td>
                  <td>-0.02608</td>
                  <td>0.01599</td>
                  <td>-0.05683</td>
                  <td>0.0146 </td>
                </tr>
                <tr>
                  <td>log(realWg)</td>
                  <td> 0.38525</td>
                  <td>0.27094</td>
                  <td> 0.76965</td>
                  <td>0.22409</td>
                </tr>
                <tr>
                  <td>MajorityLAB</td>
                  <td> 0.23452</td>
                  <td>0.04707</td>
                  <td> 0.2056 </td>
                  <td>0.04185</td>
                </tr>
                <tr>
                  <td>rho        </td>
                  <td> 0.18698</td>
                  <td>0.05349</td>
                  <td> 0.13111</td>
                  <td>0.05787</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_kuve651pmg5nbgza5laz(i, j, css_id) {
        var table = document.getElementById("tinytable_9ycn73uys0882ngj5dl5");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_9ycn73uys0882ngj5dl5');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_kuve651pmg5nbgza5laz(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_9ycn73uys0882ngj5dl5");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_kuve651pmg5nbgza5laz(0, 0, 'tinytable_css_dz6i3hf81w7f5cil5u7s') })
window.addEventListener('load', function () { styleCell_tinytable_kuve651pmg5nbgza5laz(0, 1, 'tinytable_css_dz6i3hf81w7f5cil5u7s') })
window.addEventListener('load', function () { styleCell_tinytable_kuve651pmg5nbgza5laz(0, 2, 'tinytable_css_dz6i3hf81w7f5cil5u7s') })
window.addEventListener('load', function () { styleCell_tinytable_kuve651pmg5nbgza5laz(0, 3, 'tinytable_css_dz6i3hf81w7f5cil5u7s') })
window.addEventListener('load', function () { styleCell_tinytable_kuve651pmg5nbgza5laz(0, 4, 'tinytable_css_dz6i3hf81w7f5cil5u7s') })
    </script>

  


</div>
</div>
<p>Although we could generate “density” plots using the standard errors, a more parsimonious approach might be a pair of coefficient plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinyplot)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>level <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> level)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(a, <span class="dv">1</span> <span class="sc">-</span> a)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>fac <span class="ot">&lt;-</span> <span class="fu">qt</span>(a, <span class="dv">324</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>edf_pre <span class="ot">&lt;-</span> <span class="fu">c</span>(imp_spreg_pre_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_pre_maj)[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">c</span>(imp_spreg_pre_maj[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">sqrt</span>(<span class="fu">diag</span>(spreg_pre_maj<span class="sc">$</span>var))[<span class="dv">10</span>]) <span class="sc">%o%</span> fac</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>edf_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="fu">c</span>(imp_spreg_pre_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_pre_maj)[<span class="dv">10</span>])), <span class="at">ci_low=</span>edf_pre[,<span class="dv">1</span>], <span class="at">ci_high=</span>edf_pre[,<span class="dv">2</span>], <span class="at">vars=</span><span class="fu">rownames</span>(edf_pre))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>edf_pre<span class="sc">$</span>vars[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log(realWg)"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>edf_post <span class="ot">&lt;-</span> <span class="fu">c</span>(imp_spreg_post_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_post_maj)[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">c</span>(imp_spreg_post_maj[[<span class="dv">2</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">sqrt</span>(<span class="fu">diag</span>(spreg_post_maj<span class="sc">$</span>var))[<span class="dv">10</span>]) <span class="sc">%o%</span> fac</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>edf_post <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimate=</span><span class="fu">c</span>(imp_spreg_post_maj[[<span class="dv">1</span>]][<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="dv">3</span>], <span class="fu">c</span>(<span class="fu">coef</span>(spreg_post_maj)[<span class="dv">10</span>])), <span class="at">ci_low=</span>edf_post[,<span class="dv">1</span>], <span class="at">ci_high=</span>edf_post[,<span class="dv">2</span>], <span class="at">vars=</span><span class="fu">rownames</span>(edf_post))</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>edf_post<span class="sc">$</span>vars[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"log(realWg)"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.1</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(edf_pre, <span class="fu">tinyplot</span>(<span class="at">x=</span>vars, <span class="at">y=</span>estimate, <span class="at">ymin=</span>ci_low, <span class="at">ymax=</span>ci_high, <span class="at">type=</span><span class="st">"pointrange"</span>, <span class="at">col=</span><span class="st">"blue4"</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"pre-CCT"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.9686</span>, <span class="fl">1.3786</span>), <span class="at">grid=</span><span class="cn">TRUE</span>, <span class="at">las=</span><span class="dv">3</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(edf_post, <span class="fu">tinyplot</span>(<span class="at">x=</span>vars, <span class="at">y=</span>estimate, <span class="at">ymin=</span>ci_low, <span class="at">ymax=</span>ci_high, <span class="at">type=</span><span class="st">"pointrange"</span>, <span class="at">col=</span><span class="st">"red4"</span>, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">"post-CCT"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.9686</span>, <span class="fl">1.3786</span>), <span class="at">grid=</span><span class="cn">TRUE</span>, <span class="at">las=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_talk_files/figure-html/imp_gmm_pre_post_maj_fig-1.png" style="width:80.0%" class="figure-img"></p>
<figcaption>Spatial coefficient value and chosen variable total impacts and eigenvalue-based standard errors, pre-CCT and post-CCT, GMM SLM models, 324 English districts</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-anselin+lozano-gracia:08" class="csl-entry" role="listitem">
Anselin, Luc, and N. Lozano-Gracia. 2008. <span>“Errors in Variables and Spatial Effects in Hedonic House Price Models of Ambient Air Quality.”</span> <em>Empirical Economics</em> 34: 5–34.
</div>
<div id="ref-bivand+szymanski:00" class="csl-entry" role="listitem">
Bivand, Roger, and Stefan Szymanski. 2000. <span>“Modelling the Spatial Impact of the Introduction of Compulsory Competitive Tendering.”</span> <em>Regional Science and Urban Economics</em> 30: 203–19.
</div>
<div id="ref-golgher+voss:16" class="csl-entry" role="listitem">
Golgher, André Braz, and Paul R. Voss. 2016. <span>“How to Interpret the Coefficients of Spatial Models: Spillovers, Direct and Indirect Effects.”</span> <em>Spatial Demography</em> 4: 175–205. <a href="https://doi.org/10.1007/s40980-015-0016-y">https://doi.org/10.1007/s40980-015-0016-y</a>.
</div>
<div id="ref-kelejianetal:06" class="csl-entry" role="listitem">
Kelejian, Harry H., G. Tavlas, and G. Hondroyiannis. 2006. <span>“A Spatial Modelling Approach to Contagion Among Emerging Economies.”</span> <em>Open Economies Review</em> 17: 423–41.
</div>
<div id="ref-lesage+fischer:08" class="csl-entry" role="listitem">
LeSage, James P., and Manfred M. Fischer. 2008. <span>“Spatial Growth Regression: Model Specification, Estimation and Interpretation.”</span> <em>Spatial Economic Analysis</em> 3: 275–304.
</div>
<div id="ref-lesage+pace:09" class="csl-entry" role="listitem">
LeSage, James P., and R. Kelley Pace. 2009. <em>Introduction to Spatial Econometrics</em>. Boca Raton FL: Chapman; Hall/CRC.
</div>
<div id="ref-piras+postiglione:22" class="csl-entry" role="listitem">
Piras, Gianfranco, and Paolo Postiglione. 2022. <span>“A Deeper Look at Impacts in Spatial Durbin Model with Sphet.”</span> <em>Geographical Analysis</em> 54 (3): 664–84. <a href="https://doi.org/10.1111/gean.12318">https://doi.org/10.1111/gean.12318</a>.
</div>
<div id="ref-ward+gleditsch:08" class="csl-entry" role="listitem">
Ward, M. D., and K. S. Gleditsch. 2008. <em>Spatial Regression Models</em>. Thousand Oaks, CA: Sage.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09_talk.html" class="pagination-link" aria-label="Estimation of spatial autoregressive models: methods (ML, Bayesian, GMM)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation of spatial autoregressive models: methods (ML, Bayesian, GMM)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11_talk.html" class="pagination-link" aria-label="Prediction and spatial models">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Prediction and spatial models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>